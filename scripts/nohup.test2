Using TensorFlow backend.
/home/k123/ADLxMLDS2017/scripts/rnn.py:12: UserWarning: Update your `LSTM` call to the Keras 2 API: `LSTM(256, implementation=1, return_sequences=True, activation="tanh")`
  xx = Bidirectional(rnn_lay(hidden_dim,activation=activation,return_sequences=True,consume_less ='mem'))(xx)
test.py:42: UserWarning: Update your `Model` call to the Keras 2 API: `Model(outputs=Tensor("ti..., inputs=Tensor("in...)`
  model = Model(input = first_input,output = result)
2017-10-26 03:30:24.178384: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-26 03:30:24.178425: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-26 03:30:24.178434: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-10-26 03:30:24.178441: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-10-26 03:30:24.178449: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-10-26 03:30:24.276356: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:893] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2017-10-26 03:30:24.276631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:955] Found device 0 with properties: 
name: GeForce GTX 970
major: 5 minor: 2 memoryClockRate (GHz) 1.253
pciBusID 0000:01:00.0
Total memory: 3.94GiB
Free memory: 3.82GiB
2017-10-26 03:30:24.276648: I tensorflow/core/common_runtime/gpu/gpu_device.cc:976] DMA: 0 
2017-10-26 03:30:24.276657: I tensorflow/core/common_runtime/gpu/gpu_device.cc:986] 0:   Y 
2017-10-26 03:30:24.276667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 970, pci bus id: 0000:01:00.0)
reading  ../data/mfcc.npz
reading done
(3696, 777, 39) (3696, 777, 49)
Train on 3511 samples, validate on 185 samples
Epoch 1/2000
  30/3511 [..............................] - ETA: 492s - loss: 3.9529 - acc: 0.0199  60/3511 [..............................] - ETA: 442s - loss: 3.7309 - acc: 0.0816  90/3511 [..............................] - ETA: 423s - loss: 3.6173 - acc: 0.0968 120/3511 [>.............................] - ETA: 411s - loss: 3.5078 - acc: 0.1276 150/3511 [>.............................] - ETA: 404s - loss: 3.4268 - acc: 0.1522 180/3511 [>.............................] - ETA: 397s - loss: 3.3536 - acc: 0.1719 210/3511 [>.............................] - ETA: 391s - loss: 3.3004 - acc: 0.1841 240/3511 [=>............................] - ETA: 386s - loss: 3.2274 - acc: 0.1980 270/3511 [=>............................] - ETA: 381s - loss: 3.1642 - acc: 0.2115 300/3511 [=>............................] - ETA: 377s - loss: 3.1108 - acc: 0.2213 330/3511 [=>............................] - ETA: 380s - loss: 3.0623 - acc: 0.2317 360/3511 [==>...........................] - ETA: 377s - loss: 3.0147 - acc: 0.2417 390/3511 [==>...........................] - ETA: 374s - loss: 2.9731 - acc: 0.2486 420/3511 [==>...........................] - ETA: 371s - loss: 2.9234 - acc: 0.2568 450/3511 [==>...........................] - ETA: 368s - loss: 2.8848 - acc: 0.2635 480/3511 [===>..........................] - ETA: 364s - loss: 2.8459 - acc: 0.2707 510/3511 [===>..........................] - ETA: 359s - loss: 2.8123 - acc: 0.2766 540/3511 [===>..........................] - ETA: 355s - loss: 2.7795 - acc: 0.2825 570/3511 [===>..........................] - ETA: 351s - loss: 2.7447 - acc: 0.2888 600/3511 [====>.........................] - ETA: 346s - loss: 2.7126 - acc: 0.2944 630/3511 [====>.........................] - ETA: 342s - loss: 2.6798 - acc: 0.3011 660/3511 [====>.........................] - ETA: 338s - loss: 2.6487 - acc: 0.3070 690/3511 [====>.........................] - ETA: 334s - loss: 2.6209 - acc: 0.3119 720/3511 [=====>........................] - ETA: 330s - loss: 2.5935 - acc: 0.3169 750/3511 [=====>........................] - ETA: 326s - loss: 2.5676 - acc: 0.3219 780/3511 [=====>........................] - ETA: 322s - loss: 2.5463 - acc: 0.3255 810/3511 [=====>........................] - ETA: 319s - loss: 2.5236 - acc: 0.3292 840/3511 [======>.......................] - ETA: 315s - loss: 2.5022 - acc: 0.3329 870/3511 [======>.......................] - ETA: 311s - loss: 2.4791 - acc: 0.3375 900/3511 [======>.......................] - ETA: 308s - loss: 2.4565 - acc: 0.3420 930/3511 [======>.......................] - ETA: 304s - loss: 2.4387 - acc: 0.3452 960/3511 [=======>......................] - ETA: 300s - loss: 2.4172 - acc: 0.3498 990/3511 [=======>......................] - ETA: 296s - loss: 2.3993 - acc: 0.35331020/3511 [=======>......................] - ETA: 293s - loss: 2.3775 - acc: 0.35791050/3511 [=======>......................] - ETA: 289s - loss: 2.3601 - acc: 0.36141080/3511 [========>.....................] - ETA: 285s - loss: 2.3427 - acc: 0.36491110/3511 [========>.....................] - ETA: 282s - loss: 2.3271 - acc: 0.36801140/3511 [========>.....................] - ETA: 278s - loss: 2.3100 - acc: 0.37161170/3511 [========>.....................] - ETA: 274s - loss: 2.2938 - acc: 0.37501200/3511 [=========>....................] - ETA: 271s - loss: 2.2779 - acc: 0.37851230/3511 [=========>....................] - ETA: 267s - loss: 2.2619 - acc: 0.38201260/3511 [=========>....................] - ETA: 263s - loss: 2.2481 - acc: 0.38501290/3511 [==========>...................] - ETA: 260s - loss: 2.2341 - acc: 0.38801320/3511 [==========>...................] - ETA: 256s - loss: 2.2228 - acc: 0.39031350/3511 [==========>...................] - ETA: 253s - loss: 2.2092 - acc: 0.39341380/3511 [==========>...................] - ETA: 249s - loss: 2.1979 - acc: 0.39581410/3511 [===========>..................] - ETA: 245s - loss: 2.1857 - acc: 0.39841440/3511 [===========>..................] - ETA: 242s - loss: 2.1757 - acc: 0.40041470/3511 [===========>..................] - ETA: 238s - loss: 2.1626 - acc: 0.40361500/3511 [===========>..................] - ETA: 235s - loss: 2.1503 - acc: 0.40641530/3511 [============>.................] - ETA: 231s - loss: 2.1390 - acc: 0.40881560/3511 [============>.................] - ETA: 227s - loss: 2.1272 - acc: 0.41171590/3511 [============>.................] - ETA: 224s - loss: 2.1163 - acc: 0.41421620/3511 [============>.................] - ETA: 220s - loss: 2.1077 - acc: 0.41591650/3511 [=============>................] - ETA: 217s - loss: 2.0985 - acc: 0.41781680/3511 [=============>................] - ETA: 213s - loss: 2.0887 - acc: 0.41981710/3511 [=============>................] - ETA: 210s - loss: 2.0787 - acc: 0.42221740/3511 [=============>................] - ETA: 206s - loss: 2.0682 - acc: 0.42451770/3511 [==============>...............] - ETA: 203s - loss: 2.0587 - acc: 0.42651800/3511 [==============>...............] - ETA: 199s - loss: 2.0493 - acc: 0.42861830/3511 [==============>...............] - ETA: 196s - loss: 2.0397 - acc: 0.43051860/3511 [==============>...............] - ETA: 192s - loss: 2.0296 - acc: 0.43271890/3511 [===============>..............] - ETA: 188s - loss: 2.0197 - acc: 0.43501920/3511 [===============>..............] - ETA: 185s - loss: 2.0110 - acc: 0.43691950/3511 [===============>..............] - ETA: 181s - loss: 2.0024 - acc: 0.43881980/3511 [===============>..............] - ETA: 178s - loss: 1.9931 - acc: 0.44092010/3511 [================>.............] - ETA: 174s - loss: 1.9864 - acc: 0.44222040/3511 [================>.............] - ETA: 171s - loss: 1.9790 - acc: 0.44392070/3511 [================>.............] - ETA: 167s - loss: 1.9712 - acc: 0.44572100/3511 [================>.............] - ETA: 164s - loss: 1.9630 - acc: 0.44752130/3511 [=================>............] - ETA: 160s - loss: 1.9547 - acc: 0.44942160/3511 [=================>............] - ETA: 157s - loss: 1.9476 - acc: 0.45092190/3511 [=================>............] - ETA: 153s - loss: 1.9396 - acc: 0.45292220/3511 [=================>............] - ETA: 150s - loss: 1.9322 - acc: 0.45472250/3511 [==================>...........] - ETA: 146s - loss: 1.9250 - acc: 0.45632280/3511 [==================>...........] - ETA: 143s - loss: 1.9183 - acc: 0.45782310/3511 [==================>...........] - ETA: 139s - loss: 1.9117 - acc: 0.45932340/3511 [==================>...........] - ETA: 136s - loss: 1.9043 - acc: 0.46112370/3511 [===================>..........] - ETA: 132s - loss: 1.8970 - acc: 0.46282400/3511 [===================>..........] - ETA: 129s - loss: 1.8903 - acc: 0.46432430/3511 [===================>..........] - ETA: 125s - loss: 1.8844 - acc: 0.46562460/3511 [====================>.........] - ETA: 122s - loss: 1.8768 - acc: 0.46732490/3511 [====================>.........] - ETA: 118s - loss: 1.8702 - acc: 0.46882520/3511 [====================>.........] - ETA: 115s - loss: 1.8635 - acc: 0.47022550/3511 [====================>.........] - ETA: 111s - loss: 1.8576 - acc: 0.47162580/3511 [=====================>........] - ETA: 108s - loss: 1.8513 - acc: 0.47302610/3511 [=====================>........] - ETA: 104s - loss: 1.8451 - acc: 0.47462640/3511 [=====================>........] - ETA: 101s - loss: 1.8395 - acc: 0.47582670/3511 [=====================>........] - ETA: 97s - loss: 1.8342 - acc: 0.4770 2700/3511 [======================>.......] - ETA: 94s - loss: 1.8281 - acc: 0.47852730/3511 [======================>.......] - ETA: 90s - loss: 1.8226 - acc: 0.47982760/3511 [======================>.......] - ETA: 87s - loss: 1.8164 - acc: 0.48142790/3511 [======================>.......] - ETA: 83s - loss: 1.8106 - acc: 0.48272820/3511 [=======================>......] - ETA: 80s - loss: 1.8055 - acc: 0.48412850/3511 [=======================>......] - ETA: 76s - loss: 1.7998 - acc: 0.48552880/3511 [=======================>......] - ETA: 73s - loss: 1.7945 - acc: 0.48672910/3511 [=======================>......] - ETA: 69s - loss: 1.7894 - acc: 0.48782940/3511 [========================>.....] - ETA: 66s - loss: 1.7836 - acc: 0.48922970/3511 [========================>.....] - ETA: 62s - loss: 1.7791 - acc: 0.49033000/3511 [========================>.....] - ETA: 59s - loss: 1.7742 - acc: 0.49143030/3511 [========================>.....] - ETA: 55s - loss: 1.7696 - acc: 0.49253060/3511 [=========================>....] - ETA: 52s - loss: 1.7648 - acc: 0.49363090/3511 [=========================>....] - ETA: 48s - loss: 1.7601 - acc: 0.49473120/3511 [=========================>....] - ETA: 45s - loss: 1.7558 - acc: 0.49583150/3511 [=========================>....] - ETA: 41s - loss: 1.7510 - acc: 0.49693180/3511 [==========================>...] - ETA: 38s - loss: 1.7469 - acc: 0.49793210/3511 [==========================>...] - ETA: 34s - loss: 1.7418 - acc: 0.49913240/3511 [==========================>...] - ETA: 31s - loss: 1.7370 - acc: 0.50033270/3511 [==========================>...] - ETA: 27s - loss: 1.7323 - acc: 0.50143300/3511 [===========================>..] - ETA: 24s - loss: 1.7282 - acc: 0.50243330/3511 [===========================>..] - ETA: 21s - loss: 1.7239 - acc: 0.50343360/3511 [===========================>..] - ETA: 17s - loss: 1.7198 - acc: 0.50453390/3511 [===========================>..] - ETA: 14s - loss: 1.7155 - acc: 0.50553420/3511 [============================>.] - ETA: 10s - loss: 1.7119 - acc: 0.50633450/3511 [============================>.] - ETA: 7s - loss: 1.7075 - acc: 0.5072 3480/3511 [============================>.] - ETA: 3s - loss: 1.7044 - acc: 0.50783510/3511 [============================>.] - ETA: 0s - loss: 1.7004 - acc: 0.5088